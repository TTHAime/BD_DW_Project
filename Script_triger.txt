CREATE OR REPLACE TRIGGER TRG_ORD_DTL_SEQ
BEFORE INSERT ON ORD_DTL
FOR EACH ROW
BEGIN
  IF :NEW.SEQ IS NULL THEN
    SELECT NVL(MAX(SEQ), 0) + 1
      INTO :NEW.SEQ
      FROM ORD_DTL
     WHERE ORD_ID = :NEW.ORD_ID;
  END IF;
END;

CREATE OR REPLACE TRIGGER TRG_CMP_PRD_SEQ
BEFORE INSERT ON CMP_PRD
FOR EACH ROW
BEGIN
  IF :NEW.SEQ IS NULL THEN
    SELECT NVL(MAX(SEQ), 0) + 1
      INTO :NEW.SEQ
      FROM CMP_PRD
     WHERE CMP_ID = :NEW.CMP_ID;
  END IF;
END;

SELECT line, position, text
FROM user_errors
WHERE type = 'TRIGGER'
  AND name IN ('TRG_ORD_DTL_SEQ','TRG_CMP_PRD_SEQ')
ORDER BY name, sequence;

SELECT trigger_name, status
FROM user_triggers
WHERE trigger_name IN ('TRG_ORD_DTL_SEQ','TRG_CMP_PRD_SEQ');

SELECT * FROM DW_FACT_ORDER

ALTER TRIGGER TRG_ORD_DTL_SEQ DISABLE;
ALTER TRIGGER TRG_ORD_DTL_SEQ ENABLE;
